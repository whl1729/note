# 《ucore lab7》实验报告

[ucore在线实验指导书](https://chyyuu.gitbooks.io/ucore_os_docs/content/)

## 练习1: 理解内核级信号量的实现和基于内核级信号量的哲学家就餐问题（不需要编码）

### 题目

完成练习0后，建议大家比较一下（可用meld等文件diff比较软件） 个人完成的lab6和练习0完成后的刚修改的lab7之间的区别，分析了解lab7采用信号量的执行过程。执行 make grade ，大部分测试用例应该通过。

请在实验报告中给出内核级信号量的设计描述，并说明其大致执行流程。

请在实验报告中给出给用户态进程/线程提供信号量机制的设计方案，并比较说明给内核级提供信号量机制的异同。

### 解答

#### 1 描述内核级信号量的设计及执行流程

#### 2 描述给用户态进程/线程提供信号量机制的设计方案，并与内核级做对比

## 练习2: 完成内核级条件变量和基于内核级条件变量的哲学家就餐问题（需要编码）

### 题目
首先掌握管程机制，然后基于信号量实现完成条件变量实现，然后用管程机制实现哲学家就餐问题的解决方案（基于条件变量） 。执行： make grade 。如果所显示的应用程序检测都输出ok，则基本正确。如果只是某程序过不去，比如matrix.c，则可执行 make run-matrix命令来单独调试它。大致执行结果可看附录。

请在实验报告中给出内核级条件变量的设计描述，并说明其大致执行流程。

请在实验报告中给出给用户态进程/线程提供条件变量机制的设计方案，并比较说明给内核级提供条件变量机制的异同。

请在实验报告中回答：能否不用基于信号量机制来完成条件变量？如果不能，请给出理由，如果能，请给出设计说明和具体实现。

### 解答

#### 1 基于信号量完成条件变量的实现

#### 2 用管程机制（基于条件变量）解决哲学家就餐问题

#### 3 描述内核级条件变量的设计及执行流程

#### 4 描述管程机制的设计及执行流程

#### 5 描述给用户态进程/线程提供条件变量机制的设计方案，并与内核级做对比

#### 6 回答问题：能否不用基于信号量机制来完成条件变量

## 扩展练习 Challenge ： 在ucore中实现简化的死锁和重入探测机制（待实现）

### 题目
在ucore下实现一种探测机制，能够在多进程/线程运行同步互斥问题时，动态判断当前系统是否出现了死锁产生的必要条件，是否产生了多个进程进入临界区的情况。 如果发现，让系统进入monitor状态，打印出你的探测信息。

## 扩展练习 Challenge ： 参考Linux的RCU机制，在ucore中实现简化的RCU机制

### 题目
在ucore 下实现Linux的RCU同步互斥机制。可阅读相关Linux内核书籍或查询网上资料，可了解RCU的设计实现细节，然后简化实现在ucore中。 要求有实验报告说明你的设计思路，并提供测试用例。参考资料： [Linux 2.6内核中新的锁机制--RCU](http://www.ibm.com/developerworks/cn/linux/l-rcu/)

